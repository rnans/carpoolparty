<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sql.poolStatusSQL">
	<select id="viewOwnMemberPool" parameterType="String" resultType="su.pool.model.PoolDateDTO">
	select * from reservationlist where userid=#{id}
	</select>
	<select id="viewOwnMasterPool" parameterType="String" resultType="su.pool.model.PoolDateDTO">
	select * from reservationlist where userid=#{id}
	</select>
	<select id="getOwnMemberPoolTotalCnt">
	select count(*) from (select * from reservationlist where userid=#{id})
	</select>
	<select id="getOwnMasterPoolTotalCnt">
	select count(*) from (select * from reservationlist where userid=#{id})
	</select>
	<select id="getMembers" parameterType="int" resultType="String">
	select members from poolmasterstatus where addidx=#{addidx}
	</select>

	<insert id="intoMasterStatus" parameterType="su.pool.model.PoolMasterStatusDTO">
	insert into poolmasterstatus
	(
		idx,
		addidx,
		masterid,
		mans,
		nowmans,
		status,
		members
	) 
	values
	(
		poolmasterstatus_idx.nextval,
		#{addidx},
		#{masterid},
		#{mans},
		0,
		'모집중',
		' '
	)
	</insert>
	<insert id="inToMemberStatus" parameterType="su.pool.model.PoolMemberStatusDTO">
	insert into poolmemberstatus
	(
		idx,
		memberid,
		aimidx,
		status,
		mans
	) 
	values
	(
		poolmasterstatus_idx.nextval,
		#{memberid},
		#{aimidx},
		'예약 요청 중',
		1
	)
	</insert>
	<update id="upToMasterStatus" parameterType="su.pool.model.PoolMasterStatusDTO">
	update set poolmasterstatus 
	nowmans=nowmans+#{nowmans},
	member=member+'/'+#{member}
	where addidx=#{addidx}
	</update>
</mapper>